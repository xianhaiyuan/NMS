<%- include('iheader') %>
<link rel="stylesheet" href="/css/isignup.css">
<title>nms-isignup</title>
</head>
<body>

<div class="i_header">
    <a href="javascript:history.back()">&lt;</a>
    <h2>注册</h2>
    <h2>&nbsp;&nbsp;</h2>
  </div>
  <div class="i_main">
    <form method="post" enctype="multipart/form-data">
      <input type="text" placeholder="请输入用户名" maxlength="25" class="user_input username" name="username" required autofocus>
      <input type="password" placeholder="登录密码" maxlength="25" class="user_input password" name="password" required>
      <input type="password" placeholder="重复密码" maxlength="25" class="user_input repassword" name="repassword" required  name="repassword">
      <input type="text" placeholder="请输入姓名" maxlength="25" class="user_input name" name="name">
      <div class="field required">
        <label>性别</label>
        <select class="ui compact selection dropdown" id="gender" name="gender">
          <option value="m">男</option>
          <option value="f">女</option>
          <option value="x">保密</option>
        </select>
      </div>
      <div class="field required">
        <label>头像</label>
        <input type="file" name="avatar" class="avatar">
      </div>
      <div class="field required">
        <label>个人简介</label>
        <textarea name="resume" rows="5" v-model="user.resume" required id="resume"></textarea>
      </div>
      <a value="注册" class="submit login">注册</a>
    </form>
  </div>
  <div class="err"></div>
<%= error %>

<script>
  (function(){
    var username = $(".username");
    var password = $(".password");
    var repassword = $(".repassword");
    var name = $(".name");
    var gender = $("#gender");
    var resume = $("#resume");
    var submit_button = $(".submit");
    submit_button.click(function(){
      if (!(username.val().length >= 1 && username.val().length <=10)){
        $(".err").html('用户名请限制在 1-10 个字符。');
        $('html, body, .i_main').animate({scrollTop: $(document).height()}, 300); 
        return false;
      }
      if(password.val().length < 3){
        $(".err").html('密码至少 3 个字符');
        $('html, body, .i_main').animate({scrollTop: $(document).height()}, 300); 
        return false;
      }
      if(password.val() !== repassword.val()){
        $(".err").html('两次输入密码不一致');
        $('html, body, .i_main').animate({scrollTop: $(document).height()}, 300); 
        return false;
      }
      if (!(name.val().length >= 1 && name.val().length <=10)){
        $(".err").html('姓名请限制在 1-10 个字符。');
        $('html, body, .i_main').animate({scrollTop: $(document).height()}, 300); 
        return false;
      }
      if(['m', 'f', 'x'].indexOf(gender.val()) === -1){
        $(".err").html('性别只能是男,女或保密');
        $('html, body, .i_main').animate({scrollTop: $(document).height()}, 300); 
        return false;
      }
      if($(".avatar").val() === ""){
        $(".err").html('缺少头像');
        $('html, body, .i_main').animate({scrollTop: $(document).height()}, 300); 
        return false;
      }
      if(!(resume.val().length >= 1 && resume.val().length <=30)){
        $(".err").html('个人简介请限制在 1-30 个字符');
        $('html, body, .i_main').animate({scrollTop: $(document).height()}, 300); 
        return false;
      }
      $("form").submit();
    })
  })();
</script>
<%- include('ifooter') %>